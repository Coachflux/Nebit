<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Referral Dashboard — USDT Miner</title>
<style>
  body{margin:0;background:linear-gradient(135deg,#061021,#10203a);font-family:Inter,Arial;color:#e6f7ff}
  .wrap{display:flex;align-items:center;justify-content:center;min-height:100vh;padding:28px}
  .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.04));padding:26px;border-radius:18px;width:360px;box-shadow:0 20px 60px rgba(0,0,0,0.6)}
  h1{text-align:center;color:#9ff6ff}
  .small{color:#9fbfd4}
  .box3d{height:180px;background:#0f2434;border-radius:14px;margin-top:12px;display:flex;align-items:center;justify-content:center;flex-direction:column}
  .row{display:flex;gap:10px;margin-top:12px}
  .btn{flex:1;padding:10px;border-radius:10px;border:none;background:linear-gradient(90deg,#00d4ff,#7b5cff);color:#021427;font-weight:800;cursor:pointer}
  .timer{background:#071827;padding:12px;border-radius:10px;margin-top:12px;text-align:center}
  .refbox{background:#071827;padding:12px;border-radius:10px;margin-top:12px;color:#9fbfd4}
  .invite{margin-top:12px;padding:12px;border-radius:10px;border:none;background:linear-gradient(90deg,#00d4ff,#7b5cff);color:#021427;font-weight:800;cursor:pointer;width:100%}
  .footer{margin-top:10px;text-align:center;color:#9fbfd4;font-size:13px}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>USDT Miner</h1>
      <p class="small">Invite friends and earn 0.3 USDT each</p>

      <div class="box3d" id="box3d">
        <img src="https://i.ibb.co/kMG4ZjM/usdt-banner.png" width="72" alt="">
        <div style="height:10px"></div>
        <div id="rewardLabel" style="font-weight:800">Claim 100 NEB</div>
      </div>

      <div class="row">
        <button id="left" class="btn">Claim 100NEB</button>
        <button id="right" class="btn">Claim $50 BNB</button>
      </div>

      <div class="timer" id="countdown">00:00:00</div>

      <div class="refbox">
        <div>Username: <strong id="usernameDisplay">-</strong></div>
        <div style="margin-top:6px">Referral Code: <strong id="refCode">-</strong></div>
        <div style="margin-top:6px">Referred People: <strong id="refCount">0</strong></div>
      </div>

      <button id="inviteBtn" class="invite">Invite — Share Link</button>

      <div class="footer">© Nebit Campaign, 2025. Powered by BRAVE.</div>
    </div>
  </div>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDR_rkTfGLWWX4NRWOVer9wwGlUFiRMRO4",
    authDomain: "usdt-login.firebaseapp.com",
    databaseURL: "https://usdt-login-default-rtdb.firebaseio.com",
    projectId: "usdt-login",
    storageBucket: "usdt-login.firebasestorage.app",
    messagingSenderId: "807602854227",
    appId: "1:807602854227:web:309ae73f572e48dbc7a9a6"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  // require logged-in user
  auth.onAuthStateChanged(async (user) => {
    if(!user) { window.location.href = 'login.html'; return; }
    const uid = user.uid;
    const doc = await db.collection('users').doc(uid).get();
    if(!doc.exists){ alert('User data not found'); return; }
    const data = doc.data();
    document.getElementById('usernameDisplay').textContent = data.username || data.email || '-';
    document.getElementById('refCode').textContent = data.referralCode || data.username || '-';
    document.getElementById('refCount').textContent = data.referralCount || 0;
  });

  // simple flip-like UI when selecting reward
  document.getElementById('left').addEventListener('click', ()=>{ document.getElementById('rewardLabel').textContent = 'Claim 100 NEB'; });
  document.getElementById('right').addEventListener('click', ()=>{ document.getElementById('rewardLabel').textContent = 'Claim $50 BNB'; });

  // Countdown (demo)
  let seconds = 60*60*24;
  setInterval(()=>{
    if(seconds>0) seconds--;
    const h = String(Math.floor(seconds/3600)).padStart(2,'0');
    const m = String(Math.floor((seconds%3600)/60)).padStart(2,'0');
    const s = String(seconds%60).padStart(2,'0');
    document.getElementById('countdown').textContent = `${h}:${m}:${s}`;
  },1000);

  // Invite button: shows share with OG-friendly URL via server redirect if available
  document.getElementById('inviteBtn').addEventListener('click', async ()=>{
    const user = auth.currentUser;
    if(!user){ alert('Please login'); return; }
    const doc = await db.collection('users').doc(user.uid).get();
    const code = doc.data().referralCode || doc.data().username;
    const shareUrl = `https://usdtmining.github.io/USDT/index.html?ref=${encodeURIComponent(code)}`;
    const shareText = `Join USDT Miner with my code ${code}\n${shareUrl}`;

    if(navigator.share){
      navigator.share({title:'Join USDT Miner', text: shareText, url: shareUrl}).catch(()=>{});
    } else {
      await navigator.clipboard.writeText(shareText);
      alert('Link copied to clipboard. Share it on social apps.');
    }
  });
</script>
</body>
</html>
